---
import Layout from '~/layouts/PageLayout.astro'

const artworks = [
  { artist: "Anyang", discord: "Anyang", image: "/FANART/Anyang.webp" },

  // رسمتين من MARIYO
  { artist: "Mariyo", discord: "Mariyo", image: "/FANART/Mariyo.webp" },
  { artist: "Mariyo", discord: "Mariyo", image: "/FANART/Mariyo.png" },

  { artist: "NORH", discord: "NORH", image: "/FANART/NORH.webp" },
  { artist: "kanai", discord: "kanai", image: "/FANART/kanai.webp" },
  { artist: "pekz0", discord: "pekz0", image: "/FANART/pekz0.webp" },
]
---

<Layout metadata={{ title: "Fan Art — TNX6", ignoreTitleTemplate: true }}>
  <section class="py-24 px-6 text-white">
    <h1
      class="text-5xl font-extrabold text-center mb-4 bg-gradient-to-r from-[#ffda6a] to-[#c29200] bg-clip-text text-transparent drop-shadow-[0_0_10px_rgba(198,164,79,0.5)]"
    >
      Fan Art Gallery
    </h1>

    <p class="text-center text-sm text-white/70 mb-14">
      الكريديت ظاهر على كل صورة — اضغط على أي رسمة عشان تنفتح كاملة.
    </p>

    <div class="fanart-grid grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 max-w-5xl mx-auto">
      {artworks.map((a) => (
        <div
          class="fanart-card group relative overflow-hidden rounded-3xl bg-black/30 border border-white/5
                 shadow-lg backdrop-blur-sm cursor-pointer transition-transform will-change-transform hover:scale-[1.02]"
          role="button"
          tabindex="0"
          data-src={a.image}
          data-artist={a.artist}
          data-discord={a.discord}
          aria-label={`Open fan art by ${a.artist}`}
        >
          <img
            src={a.image}
            alt={`Fan art by ${a.artist}`}
            loading="lazy"
            class="fanart-img w-full h-[240px] sm:h-[260px] object-cover transition-transform duration-200"
          />

          <!-- خفيف عشان الكريديت يبان -->
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/10 to-transparent pointer-events-none"></div>

          <!-- Credit bottom-left -->
          <div
            class="absolute left-3 bottom-3 z-10 bg-black/60 backdrop-blur-md rounded-xl px-3 py-2 border border-white/10"
          >
            <div class="text-sm font-extrabold text-[#f7e6ac] leading-none">
              {a.artist}
            </div>
            <div class="text-xs text-[#f7e6ac]/75 mt-1 leading-none">
              @{a.discord}
            </div>
          </div>
        </div>
      ))}
    </div>
  </section>

  <!-- Popup (نفس فكرة صفحة الفائزين) -->
  <div
    id="popup"
    class="fixed inset-0 bg-black/80 hidden items-center justify-center z-50 p-4"
    aria-hidden="true"
  >
    <div
      id="popupInner"
      class="popup-inner relative bg-black/55 border border-[#c6a44f]/40 rounded-2xl p-4
             shadow-[0_0_30px_rgba(198,164,79,0.35)] backdrop-blur-md w-[min(1100px,95vw)]"
    >
      <div class="flex items-start justify-between gap-3 mb-3">
        <div>
          <h2 id="popupName" class="text-2xl font-extrabold text-[#ffda6a] leading-tight"></h2>
          <p id="popupHandle" class="text-sm text-[#f7e6ac]/75"></p>
        </div>

        <button
          id="closePopup"
          class="w-11 h-11 rounded-xl bg-[#c29200]/40 hover:bg-[#ffda6a]/80 text-black font-black transition"
          type="button"
          aria-label="Close"
          title="Close"
        >
          ×
        </button>
      </div>

      <img
        id="popupImg"
        class="w-full max-h-[78vh] object-contain rounded-xl bg-black/20 border border-white/10"
        alt=""
      />
    </div>
  </div>

  <style is:global>
    /* نفس إحساس "Filter Card Effects": باقي الكروت تنطفي + تقل saturate + blur خفيف */
    @media (hover: hover) and (pointer: fine) {
      .fanart-grid:hover > .fanart-card:not(:hover) .fanart-img {
        filter: brightness(0.35) saturate(0.25) blur(6px) contrast(1.1);
        transform: scale(1.02);
      }
      .fanart-grid:hover > .fanart-card:hover .fanart-img {
        filter: saturate(1.15) contrast(1.05);
        transform: scale(1.06);
      }
    }

    .popup-inner.animate-in { animation: fadeScale 260ms ease both; }

    @keyframes fadeScale {
      from { opacity: 0; transform: scale(.96); }
      to   { opacity: 1; transform: scale(1); }
    }
  </style>

  <script is:inline>
    const cards = document.querySelectorAll('.fanart-card');
    const popup = document.getElementById('popup');
    const popupInner = document.getElementById('popupInner');
    const popupImg = document.getElementById('popupImg');
    const popupName = document.getElementById('popupName');
    const popupHandle = document.getElementById('popupHandle');
    const closePopup = document.getElementById('closePopup');

    const openPopup = (src, artist, discord) => {
      popupImg.src = src;
      popupImg.alt = `Fan art by ${artist}`;
      popupName.textContent = artist;
      popupHandle.textContent = `@${discord}`;

      popup.classList.remove('hidden');
      popup.classList.add('flex');
      popup.setAttribute('aria-hidden', 'false');

      popupInner.classList.remove('animate-in');
      void popupInner.offsetWidth;
      popupInner.classList.add('animate-in');
    };

    const close = () => {
      popup.classList.remove('flex');
      popup.classList.add('hidden');
      popup.setAttribute('aria-hidden', 'true');
      popupInner.classList.remove('animate-in');
      popupImg.src = '';
      popupImg.alt = '';
    };

    cards.forEach(card => {
      const { src, artist, discord } = card.dataset;

      card.addEventListener('click', () => openPopup(src, artist, discord));
      card.addEventListener('keyup', (e) => {
        if (e.key === 'Enter' || e.key === ' ') openPopup(src, artist, discord);
      });
    });

    closePopup.addEventListener('click', close);
    popup.addEventListener('click', (e) => { if (e.target === popup) close(); });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') close(); });
  </script>
</Layout>
